## 📌 Phase-04 | ai\_pipeline\_ml: 머신러닝 기반 감성 분석 자동화

### 🔍 목적

사전학습 기반 대형 언어 모델(LLM, GPT API)과<br> 
지도학습 기반 전통 머신러닝 모델을<br> 
동일한 감성 분석에 적용하여,
성능, 비용, 통제 가능성 측면에서<br> 
실무 운영에 더 적합한 방법을 검증하고<br> 
실제 파이프라인에 적용하는 것이었음.

이를 위해 다음과 같은 기준에서 두 접근법을 비교함:

1. **비용 대비 성능**

   * GPT API는 별도의 학습 없이 즉시 사용 가능하나, 토큰당 비용 발생 및 응답 일관성 설정 필요
   * 머신러닝 모델은 초기 구축이 필요하지만, 추론 비용이 없고 경량화·튜닝이 가능함

2. **정확도 및 통제력**

   * LLM은 Black-box 성격으로 결과 해석이 어려움
   * ML 모델은 벡터화, 분류기 구조, 학습 데이터 등 개발자가 직접 제어 가능하여 <br>재현성 및 정책적 설명력이 요구되는 감성 분석 환경에 더 적합함

3. **운영 및 유지보수 효율성**

   * GPT API는 외부 서비스에 의존하므로 버전 종속성 및 호출 제한 등 이슈가 있음
   * 머신러닝 모델은 내부 인프라(AWS EC2 등)에서 직접 추론이 가능하며, 독립적 운영과 유지보수가 용이함

---

### 🔄 Phase-03 (GPT API) 요약

• GPT API 기반 감성 분석은 초기 빠른 구축 및 정확도 확인을 위한 **Baseline 모델**<br>
• JSON 형식으로 응답 형식을 강제하여 일관성과 정형성 확보<br>
• `max_tokens=200`, `temperature=0.3` 설정으로 비용 최적화 및 응답 일관성 유지<br>
• 감성 라벨 + 감성 스코어 반환 (Positive / Neutral / Negative)<br>
• 프로젝트 초기 빠른 구현을 목표로 하였으며, 머신러닝 성능 비교 후 우수한 쪽으로 교체 적용할 계획의 일환으로 활용됨

---

### ⚙️ 머신러닝 모델 설계 및 구성

#### 1. 학습 데이터 구축

• `label_train_data`, `rss_news_storage` 테이블 기반으로 CSV 생성<br>
• 초기에는 감성별 뉴스 분류를 위해 **LightGBM + FastText 기반 자동 라벨러 모델**을 개발하였으나 성능이 낮아 폐기함<br>
• 대안으로, 감성 라벨이 포함된 공개 뉴스 소스를 활용하여 뉴스 및 라벨을 크롤링하여 학습 데이터로 활용  
  → 크론탭으로 1시간마다 자동 수집<br>
• 추론용 뉴스는 `rss_news_storage` 테이블에 저장되며,  
  → RSS Feed 제공 12개 사이트로부터 크론탭으로 30분마다 자동 수집됨  
  → 학습용/추론용 데이터는 매일 1회 크론탭으로 자동 백업

#### 2. 전처리 및 벡터화

• 텍스트 정제: XML 파싱 (`requests + BeautifulSoup`), 불용어 제거, 중요어 사전 기반 키워드 보존
• 벡터화: TF-IDF를 통해 뉴스 본문을 수치화하여 **분류 모델의 입력값으로 사용**

#### 3. 분류 모델 학습 및 성능 평가

• 벡터화된 데이터를 전통 ML 분류 모델들에 입력하여 학습 수행:

* Logistic, SVM, Ridge, GradientBoost, Naive Bayes, SGD<br>
  • 주요 성능 지표: Accuracy, Precision, Recall, F1 Score, Specificity, NPV, Log Loss (손실 계수)<br>
  • 각 모델은 기본적으로 클래스만 예측하지만,<br> 실제 감성 점수 활용을 위해 `predict_proba()` 기반 확률 출력을 도입하고,<br>
    이를 `2p - 1`로 변환하는 스케일링 후처리를 적용하여 -1 \~ 1 범위의 감성 점수를 생성함<br>
  • 해당 점수를 기준으로 감성 라벨(`0: 부정, 1: 중립, 2: 긍정`)을 자동 할당<br>
  • 성능 평가 결과 Precision 기준에서 가장 우수한 **SVM 모델을 최종 선정**하였으며,<br> `GridSearchCV`를 통해 하이퍼파라미터 튜닝을 수행함

---

### 📊 GPT API vs 머신러닝 모델 성능 비교

| 항목        | GPT API | 머신러닝 모델(SVM) | 결과         |
| --------- | ------- | ------------ | ---------- |
| Accuracy  | 0.84    | 0.84         | 동일         |
| Precision | 0.83    | 0.85         | ▲ 2.41% 향상 |
| Recall    | 0.83    | 0.80         | ▼ 3.61% 하락 |
| Macro F1  | 0.82    | 0.82         | 동일         |

• **Recall**: 실제 긍정/부정을 놓치지 않고 얼마나 잘 찾아내는지 (민감도)<br>
• **Precision**: 모델이 긍정/부정이라고 예측한 것 중 실제로 맞는 비율 (정확도)<br>
• GPT는 Recall 우위, ML은 Precision 우위 → 사용 목적에 따라 선택이 달라질 수 있음<br>
• 본 프로젝트에서는 긍정/부정으로 잘못 판단하는 비율을 줄이는 것이 중요했기 때문에 <br>Precision을 중시하였고, 머신러닝 모델(SVM)을 최종 선택함

---

### ✅ 결론
• GPT API는 Phase-03에서 Baseline 모델로 활용되었음<br>
• 머신러닝 모델은 성능, 비용, 통제력 측면에서 유리하여 최종 교체 적용되었음<br>
• 실시간 감성 분석 파이프라인은 해당 머신러닝 모델 기반으로 운영되어,<br>
AWS EC2 환경에서 .pkl 형식으로 경량화된 모델을 로딩하여 효율적인 추론 처리를 수행

